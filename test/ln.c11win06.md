#  组合问题的常见思想方法简要总结

##  `讲义`

### 一

在 "组合计数" 或 "组合恒等式 (不等式)" 问题中, 常见的思想方法有: 枚举法、乘法原理、加法原理、排列数与组合数公式、容斥原理、递推、数学归纳、算两次、构造对应、构造母函数等. 这些方法在以前的讲义中大多已经提到, 这里再举一些例子.

#### 例 1

("配对" 或 "对应" 思想举例)

(1) 设 $S = \{1 , 2 , 3 , \cdots ,2015 \}$, $A$ 是 $S$ 的子集, $|A| = 31$, 且 $A$ 中元素之和是 5 的倍数. 求这种集合 $A$ 的个数. (答案允许用排列数或组合数表示) 
(2) 设集合 $A = \{1 , 2 , 3 , \cdots , n \}$, 函数 $f: A \to A$ 满足条件, 任意 $i ,j \in A$, 若 $i \le j$, 则 $f(i) \le f(j)$. 求这样的函数 $f$ 有多少个?
(3) 在数列 $1 , 9 , 9^2 , \cdots , 9^{2014}$ 中删去最高位数字是 9 的项, 问剩下的数字有多少项? 参考数据: $\lg_3 \approx 0.477121$.

> (1) $\dfrac 15 C_{2015}^{31}$.
>
> 设 $A = \{a_1 , a_2 , \cdots , a_{31}\}$, 则 $\{a_1 + k, a_2 + k, \cdots, a_{31} + k\}$ 中的元素之和除以 5 余数为 $k$ (若某个 $a_i + k$ 超过了 2015, 则用 $a_i + k - 2015$ 换下来). 这样元素个数是 31 的所有集合之间, 除以 5 余数是 $0,1,2,3,4$ 的集合是相等的. 所以, 这样的 $A$ 共 $\dfrac 15 C_{2015}^{31}$ 个.
>
> (2) $C_{2n-1}^n$.
>
> 考虑 $f(1) -1, f(2) -f(1), \cdots, f(n) - f(n-1), n -f (n)$ 这个数列和 $f$ 构成一一对应.
>
> (3) 1922.
>
> 数列中某项首位数字是 9, 则前一项首位数字是 1, 前后二项位数相同, 反之也对, 即首位数字为 9 的项与前后二项位数相同的两项之间一一对应. 删去前后两项位数相同的两项中的后一项, 余下数列中个数的位数恰好为 $1, 2 , \cdots, t$, 共有 $t$ 项. 其中 $t$ 为 $9^{2014}$ 的位数. 
>
> 而 $t = [\lg 9^{2014}] + 1 = [4028\lg 3] +1 = 1922$. 即剩下 1922 项.

#### 例 2

圆周上有 $n (n \ge 6)$ 个点, 每两点连一线段, 假设其中任意三条线段在圆内不共点, 于是任意三条两两相交的线段构成一个三角形, 试求这些线段确定的三角形的个数.

> $C_n^3 +4C_n^4 +5C_n^5 +C_n^6$.
>
> 称圆周上的点为外点, 任意两条对角线在圆内的交点为内点. 则所确定的三角形按其顶点可以分为 4 类:
>
> (1) 三角形顶点均为外点: 和圆周上的 3 点组集合成一一对应, 共 $C_n^3$ 个.
> (2) 三角形顶点 2 个外点, 1 个内点: 对应于圆周上的 4 点组, 一个四点组对应三个三角形, 共 $4C_n^4$ 个三角形.
> (3) 三角形顶点 1 个外点, 2 个内点: 对应于圆周上的 5 点组, 一个五点组对应五个三角形, 共 $5C_n^5$ 个三角形.
> (4) 三角形顶点均为内点: 对应于圆周上的 6 点组, 一个六点组对应 1 个三角形, 共 $C_n^6$ 个三角形.
>
> 从而共 $C_n^3 + 4C_n^4 + 5C_n^5 + C_n^6$ 个三角形.

#### 例 3

(数学归纳法举例)

有多少方法能从 1 到 $n$ 的 $n$ 个整数排成下面的排列: 除了左边的第一个整数外, 每个数都与它左方 (不必相邻) 的某一个数相差 1? 

> 举一些 $n$ 比较小的数, 猜测:
>
> (1) $n$ 排列必定以 1 或 $n$ 结尾;
> (2) $n$ 排列的个数为 $2^{n - 1}$.

#### 例 4

(递推法举例)

(1) $n$ 个点 $P_1 , P_2 , \cdots, P_n$ 顺次在一条直线上, 每个点染上白、红、绿、蓝、紫色中的一种颜色, 若对任意相邻的两点, 要么这两点同色, 要么至少有一点为白色, 则称之为好的染法. 求好的染法的总数.
(2) 在圆周上给定 20 个点 (编号为 1 到 20), 并用 10 条既无公共端点, 又互相不交的弦来连接它们. 问: 共有多少种不同的连线法.

> (1) $\dfrac 12(3^{n+1}+(-1)^{n+1})$.
>
> 设 $a_n$ 表示 $P_n$ 染白色的好的染法, $b_n$ 表示 $P_n$ 不染白色的好的染法, 则 $c_n = a_n + b_n$ 为好的染法的总数. 由 $a_n, b_n, c_n$ 的定义可知: $a_n = c_{n -1}, b_n = 4a_{n -1} + b_{n-1}$, 所以 $c_n = a_n + b_n = c_{n - 1} + b_{n -1} + 4a_{n -1} = c_{n - 1} + b_{n - 1} + 4c_{n-2}$, 注意到 $b_n = c_n - a_n = c_n - c_{n - 1}$, 代入上式得,  $c_n = 2c_{n -1} + 3c_{n-2}$, 易知 $c_1 = 5, c_2 = 13$, 由特征根法即得 $c_n = \dfrac 12(3^{n+1}+(-1)^{n+1})$. 故所求好的染法总数为 $\dfrac 12(3^{n+1}+(-1)^{n+1})$.
>
> (2) 16796.
>
> 设当圆周上有 $2n$ 个点, 用 $n$ 条弦来连接它们时, 满足要求的连法有 $kn$ 个. 
>
> 可以得到递推关系式: $k_n = k_{n-1} + k_1k_{n-2} + k_2k_{n-3} + \cdots k_{n-2}k_1 + k_{n -1}$. 容易看出 $k_1=1, k_2 = 2$. 依次算出 $k_{10} = 16796$.

#### 例 5

(算两次举例)

设 $n$ 和 $k$ 是正整数, $S$ 是平面内 $n$ 个点的集合, 满足:

(1) $S$ 中任意三点不共线;
(2) 对 $S$ 中每一个点 $P$, $S$ 中至少有 $k$ 个点与 $P$ 的距离相等.

求证: $k < \dfrac 12 +\sqrt{2n}$.

> 设 $S = \{P_1, \cdots , P_n\}$, 则对任意 $P_i \in S$, 存在以 $P_i$ 为圆心的圆 $C_i$, 在 $C_i$ 有 $r_i$ 个 $S$ 中的点, 且 $r_i \ge k$. 
>
> 设 $P_i$ 在 $C_1, C_2, \cdots, C_n$ 中的 $e_i$ 个圆上. 则 $e_1 + e_2 +\cdots + e_n = r_1 + r_2 +\cdots + r_n \ge kn$. 若 $S$ 中的点 $P_i$ 同 
> $ 2C_n^2 \ge \sum C_{e_i}^2 =\dfrac 12(\sum e_i^2 -\sum e_i) \ge \dfrac 12(\dfrac 1n (\sum e_i)^2 -\sum e_i)=\dfrac 1{2n}\cdot (\sum e_i)\cdot (\sum e_i -n) \ge \dfrac 12 \cdot kn \cdot (kn-n)$
> 解不等式即可.

### 二

在存在性问题中, 极端原理是常用的一个方法. 极端原理是从所考察对象中的极端对象入手 (如最大、最小、最多、最少等) 解决问题的一种思想. 它常常和反证法配合, 从结论的否定出发, 利用极端元素导致矛盾, 从而推出结论成立.

#### 例 6

求证: 在四面体 $ABCD$ 中, 必有某个顶点, 从它发出的三条棱作为三边可以构成一个三角形. 

> 不妨设 $AB$ 是最长的边, 并假设题中结论不成立. 则 $AD + AC \le AB$,  $BD + BC \le AB$, 
>
> 两式相加得, $(AD + AC) + (BD + BC) \le 2 AB < (AC + BC) + (AD + BD)$ 矛盾.

#### 例 7

有 $n (n \ge 3)$ 个人进行比赛, 每两个人各进行了一局比赛. 已知没有平局, 且没有人全胜. 求证: 必存在三个人甲、乙、丙, 使甲胜乙, 乙胜丙, 丙又胜甲.

> 设甲是胜局最多的一个, 由于甲没有全胜, 故存在丙, 丙胜甲. 被甲打败的人中必存在乙, 使乙胜丙, 否则丙胜的局数就比甲多.

#### 例 8

有三所学校, 每所学校有 $n$ 名学生, 已知任意一名学生认识其他两所学校学生的总数都是 $n + 1$. 证明: 每所学校都存在一名学生, 使得这三名学生互相都认识. (认识是相互的)

> 不妨设第一所学校学生 $A$ 是所有学生中认识其他两所学校中某一所学校的人数最多的, 这个最大值 $k \le n$. 不妨设她认识第二所学校中的 k 个人. 则他至少认识第三所学校中的 $C$.如果 $C$ 认识第二所学校中 $A$ 认识的某个同学 $B$, 则证毕. 若 $C$ 不认识第二所学校中 $A$ 认识任意同学, 则 $C$ 在第二个学校最多认识 $n - k$ 个人, 从而 $C$ 将在第一个学校认识 $k - 1$ 个人. 
>
> (1) 对 $S$ 的任意一个 2 元子集 $\{a,b\} \subseteq S$, $A_1, A_2, \cdots A_k$ 中至多有两个集合包含 $\{a,b\}$. 否则, 设有 $A_1 \supseteq \{a,b\}$, $A_2 \supseteq \{a,b\}$, $A_3 \supseteq \{a,b\}$, 则由于 $|A_i \cap A_j| \le 2 (1\le i < j \le k)$, 所以 $A_i-\{a,b\} (i=1,2,3)$ 两两不交, 上述 $A_i-\{a,b\}$ 表示差集: $A-B=\{x|x\in A 且 x\notin B\}$. 但 $|A_i-\{a,b\}| = 3 (i=1,2,3)$, 于是 $|S|\ge 3\times 3+2=11$, 矛盾.
>
> (2) 对 $S$ 的任意一个元素 $a, A_1, A_2, \cdots A_k$ 按照上述思路, 可构造出符合条件的 6 个子集: $\{1,2,3,4,5\}$,$\{1,2,6,7,8\}$, $\{1,3,6,9,10\}$, $\{2,4,7,9,10\}$, $\{3,5,7,8,10\}$, $\{4,5,6,8,9\}$. 故 $k$ 的最大值为 6.

### 三 

在 "操作、变换" 等问题中, 有很多 "能不能" 的问题, 可以考虑构造 "指标" 及 "不变量", 然后考虑指标在操作过程中的变化情况. 指标或不变量, 其实是赋值法的延伸.

#### 例 9

一群小孩围坐一圈分糖果, 老师让他们先每人任取偶数块糖, 然后按下列规则调整: 所有小孩同时把自己手中的糖分一半给右边的小孩, 糖块变为奇数的人向老师要 1 块糖. 这算一次调整. 证明: 经过有限次调整后,大家的糖就变得一样多了.

> 方法一:
> 设有 $n$ 个小孩, 第 $i$ 个小孩手中的糖果数是 $x_i$, 定义方差 $\sum x_i^2 -\dfrac {(\sum x_i)^2} n$, 只需证明该方差在一次调整后是不增的.
>
> 方法二:
> 设某次调整前, 糖果最多的有 $a_{\max}$ 个, 糖果最小的有 $a_{\min}$ 个, 不妨设 $a_{\max} > a_{\min}$.
>
> (1) 经过一次调整后, 糖果数仍在 $a_{\max}$ 和 $a_{\min}$ 之间 (包括两者);
> (2) 原来大于 $a_{\min}$ 的,在调整一次后仍然大于 $a_{\min}$;
> (3) 至少存在一个 $a_{\min}$ 的糖果数会增大.
>
> 这样经过若干次调整, 必有 $a_{\min}$ 会增大, 而 $a_{\max}$ 不增大. 证毕.

### 四

组合问题或许在逻辑上可以大致分为三类:

1. 存在性问题 --- 是否存在?
2. 计数问题 --- 有多少?
3. 最值问题 (或不等式证明) --- 最多或最少是什么?

要论证存在性, 最直接手段当然是构造 --- 给出一个明确的局面或算法, 从而证明结论.

#### 例 10

平面内有 2000 个不同的点, 证明: 可以用一些圆盘盖住这 2000 个点, 且这些圆盘满足

(1) 直径之和不超过 2000;
(2) 任意两个圆盘的距离大于 1.

> 边构造边调整 (逐步调整法或局部调整法). 
>
> 用 2000 个单位圆覆盖住这些圆. 并且圆心恰好为 2000 个已知点. 若两个圆有公共点 (包括相切的情形), 则用尽可能小的大圆盖住这两个小圆.
>
> 最后可以保证: 
> (1) 直径之和不超过 2000;
> (2) 任意两个圆盘的距离大于零; 
> (3) 被圆盘覆盖住的点不距离圆盘边界的距离大于等于 $\dfrac 12$.
>
> 设这些圆之间的最小距离为 $d$. 则让每个圆的半径缩短 $\dfrac 12 -\dfrac d 3$. 这样任意两圆距离大于等于 $d+\dfrac 12-\dfrac d 3 =1+\dfrac d 3>1$.


#### 例 11

由 $2 \times 2$ 的方格纸去掉一个方格余下一个 "拐形". 那么若干个拐形能否覆盖 $2005 \times 2007$ 的方格表? (必须方格对准方格, 不能超出方格线或重叠)

> 递归构造.
>
> 可以. 事实上 $m \times n$ 如果是 3 的倍数, 且不是形如 $3 \times$ 奇数的形式, 都可以被覆盖.
>
> 归纳证明. 不难构造出 $6 \times 4, 6 \times 5 , 9 \times 4 , 9 \times 5$ 这四个情形.
>
> 若 $3n \times m$ 已经被构造, 则容易构造 $3n \times (m + 2)$, 进而可以构造 $3(n + 2) \times m$. 证毕.

#### 例 12 `第 9 届 CMO`

现有 $n (n \ge 4)$ 个盘子中放有总数不少于 4 的糖块. 每次操作时, 可以挑选两个有糖果的盘子, 并各取一个糖块放入第三个盘子. 问: 经过有限次操作, 能否把所有的糖块集中到一个盘子里去?

> 能.
>
> 归纳证明. 
>
> 若开始只有 4 块糖, 分布将有 4 种情况, 逐个讨论即可. 
>
> 在 $m = k + 1$ 时, 则其中 $k$ 块糖可以放到一个盘子中. 若第 $k + 1$ 块糖本来就在这个盘子里, 证毕. 
>
> 若不在, 则 $(k,1,0,0) \to (k - 1,0,2,0) \to (k - 2,2,1,0) \to (k - 3,2,0,2) \to (k - 1,1,0,1) \to (k +1,0,0,0)$.

##  `作业`

1.  一堆石子有 100 个, 将这堆石子分成两堆 $A_1$ 和 $A_2$, 将中所含石子的个数相乘. 然后再将 $A_1$ 和 $A_2$ 这两堆分别地分成两堆, 分别记作 $A_{11}$ 和 $A_{12}$ (是 $A_1$ 分成的), $A_{21}$ 和 $A_{22}$ (是 $A_2$ 分成的), 将 $A_{11}$ 和 $A_{12}$ 中所含石子的个数相乘, 将 $A_{21}$ 和 $A_{22}$ 中所含石子的个数相乘 $\cdots \cdots$ 这样一直进行下去 (若一堆中石子个数为 1, 则不理它), 直到所有堆中石子都只有一个. 最后把所有乘积加起来, 求证: 这些乘积的和是定值.

   > 设原来共有 $n$ 个石子, 猜测这些乘积的和为 $\dfrac {n(n-1)}2$.
   >
   > 归纳证明, 设 $k_1 + k_2 = n$. 则 $\dfrac {k_1(k_1-1)}2 + \dfrac {k_2(k_2-1)}2 +k_1k_2  = \dfrac {(k_1+k_2)(k_1+k_2-1)}2 =\dfrac {n(n-1)}2$, 证毕.

2. 今有编号为 $1 , 2 , 3 ,\cdots,10$ 的十把钥匙与编号为 $1 , 2 , 3 ,\cdots,10$ 的十只箱子, 每把钥匙只能打开与之号数相同的箱子, 现将所有钥匙都放进去这些箱子中. 每只箱子放一把钥匙. 然后锁上. 那么有多少种不同的放法, 使得至少要撬开两只箱子才能将箱子全部打开? 若存在两只箱子, 撬开它们, 就能将其他箱子全部打开, 又有多少放法? (答案允许用排列数或组合数表示)

   > 钥匙的放法 $p$ 向当于 $1 , 2 , 3 ,\cdots, 10$ 的一个排列, 故 $p$ 是若干个轮换的乘积.至少要撬开两只箱子, 则圈的个数至少有两个. 用总放法减去只有一个轮换的放法, 故答案是 $10! - 9! = 9 \cdot 9!$.
   >
   > 若存在两只箱子, 撬开它们, 就能将其他箱子全部打开相当于恰有一个圈或两个圈. 故答案是: $9! + C_{10}^1 \cdot 8! + C_{10}^2  7! + C_{10}^3 \cdot 2! \cdot 6! + C_{10}^4 \cdot 3! \cdot 5! +\dfrac 12 \cdot C_{10}^5 \cdot 4! \cdot 4!$. 

3. 一个数列有 $n$ 项, 每一项在 $\{0,1, 2\}$ 中取值, 且相邻两项的差的绝对值不超过 1. 这样的数列共有多少个?

   > 设 1 开头的这样的数列有 $x_n$ 个, 0 或 2 开头的数列有 $y_n$ 个. 则 $x_n =x_{n-1} +2y_{n-1}$, $y_n =x_{n-1}+y_{n-1}$. 
   >
   > 故 $x_n + y_n = 2(x_{n -1} + y_{n-1}) + (x_{n-2} + y_{n - 2})$. 又 $x_1 + y_1 = 3, x_2 + y_2 = 7$, 解得 $x_n+y_n =\dfrac {(1+\sqrt 2)^{n+1}}2 +\dfrac {(1-\sqrt 2)^{n+1}}2$.